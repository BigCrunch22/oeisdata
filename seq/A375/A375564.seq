%I A375564 #38 Oct 01 2024 17:50:04
%S A375564 1,2,3,4,6,8,10,5,7,9,12,14,16,18,15,20,22,11,13,17,19,21,24,26,28,30,
%T A375564 25,35,40,32,34,36,27,33,39,42,38,44,46,23,29,31,37,41,43,45,48,50,52,
%U A375564 54,51,57,60,55,65,70,49,56,58,62,64,66,63,69,72,68,74,76,78,75,80,82,84,77,88,86,90
%N A375564 a(1) = 1, a(2) = 2; for n > 2, a(n) is the smallest unused positive number that is coprime to a(n-1) if a(n-1) is prime, otherwise a(n) shares a factor with a(n-1).
%C A375564 The sequence contains groups of consecutive primes separated by groups of composite terms. See the attached image of the first 100000 terms. In this same range the primes appear in their natural order.
%C A375564 The fixed points are 1, 2, 3, 4, 15, 51, 63, 363, 437, ... There are thirty-two fixed points in the first 100000 terms and it is likely there are infinitely many in total. The sequence is conjectured to be a permutation of the positive integers.
%C A375564 Theorem: This sequence is a permutation of the positive integers. See link for proof. - _N. J. A. Sloane_, Sep 24 2024
%H A375564 Scott R. Shannon, <a href="/A375564/b375564.txt">Table of n, a(n) for n = 1..10000</a>
%H A375564 Michael De Vlieger, <a href="/A375564/a375564_1.png">Log log scatterplot of a(n)</a>, n = 1..2^16, with a color function showing primes in red, perfect powers of primes in gold, squarefree composites in green, and numbers neither squarefree nor prime powers in blue and purple, with purple additionally representing powerful numbers that are not prime powers.
%H A375564 Scott R. Shannon, <a href="/A375564/a375564.png">Image of the first 100000 terms</a>. The terms are colored red, yellow, green, blue, violet if they have one, two, three, four, or five or more prime factors. The thin white line is a(n) = n.
%H A375564 Scott R. Shannon, <a href="/A375564/a375564_2.png">Image of the first 25 million terms</a> [Conventions as in preceding image.]
%H A375564 N. J. A. Sloane, <a href="/A375564/a375564.txt">Proof that this sequence is a permutation of the positive integers</a>
%H A375564 N. J. A. Sloane, <a href="/A375564/a375564_2.txt">Table of n, a(n) for n = 1..100000</a>
%e A375564 a(8) = 7 as a(7) = 5 is a prime number, and 7 is the smallest unused number that is coprime to 5.
%t A375564 nn = 120; c[_] := False; Do[Set[{a[i], c[i]}, {i, True}], {i, 2}];
%t A375564 j = a[2]; u = 3;
%t A375564 Do[k = u; If[PrimeQ[j],
%t A375564     While[Or[c[k], GCD[j, k] > 1], k++],
%t A375564     While[Or[c[k], CoprimeQ[j, k]], k++]];
%t A375564   Set[{a[i], c[k], j}, {k, True, k}];
%t A375564   If[k == u, While[c[u], u++]], {i, 3, nn}];
%t A375564 Array[a, nn] (* _Michael De Vlieger_, Sep 29 2024 *)
%o A375564 (Python)
%o A375564 from itertools import islice
%o A375564 from math import gcd
%o A375564 from sympy import isprime
%o A375564 def A375564_gen(): # generator of terms
%o A375564     aset, a, b = {1,2}, 2, 3
%o A375564     yield from (1,2)
%o A375564     while True:
%o A375564         c = b
%o A375564         if isprime(a):
%o A375564             while c in aset or gcd(c,a)>1:
%o A375564                 c+=1
%o A375564         else:
%o A375564             while c in aset or gcd(c,a)==1:
%o A375564                 c+=1
%o A375564         aset.add(c)
%o A375564         yield (a:=c)
%o A375564         while b in aset:
%o A375564             b += 1
%o A375564 A375564_list = list(islice(A375564_gen(),20)) # _Chai Wah Wu_, Sep 30 2024
%Y A375564 Cf. A375563, A064413, A000040, A373546, A373545.
%K A375564 nonn,new
%O A375564 1,2
%A A375564 _Scott R. Shannon_, Aug 19 2024
