%I A259776 #29 Oct 26 2018 18:55:04
%S A259776 1,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,2,1,0,1,0,1,2,4,0,0,1,0,1,2,9,6,
%T A259776 1,0,1,0,1,2,9,24,13,0,0,1,0,1,2,9,44,57,24,1,0,1,0,1,2,9,44,168,140,
%U A259776 45,0,0,1,0,1,2,9,44,265,536,376,84,1,0
%N A259776 Number A(n,k) of permutations p of [n] with no fixed points and displacement of elements restricted by k: 1 <= |p(i)-i| <= k, square array A(n,k), n>=0, k>=0, read by antidiagonals.
%C A259776 Conjecture: Column k > 0 has a linear recurrence (with constant coefficients) of order = A005317(k) = (2^k + C(2*k,k))/2. - _Vaclav Kotesovec_, Jul 07 2015
%C A259776 From _Vaclav Kotesovec_, Jul 07 2015: (Start) For k > 1, A(n,k) ~ c(k) * d(k)^n
%C A259776 k  c(k)                                  d(k)
%C A259776 2  0.2840509026895102746628049030651...  1.8832035059135258641689474653620...
%C A259776 3  0.1678494211968692989590951622212...  2.6304414743928951523517253855770...
%C A259776 4  0.0973070675347403976445165510589...  3.3758288741377846847522960161445...
%C A259776 5  0.0552389982575367440330445172521...  4.1183824671958029895499633437571...
%C A259776 6  0.0309726120341077011398575643793...  4.8588208495640240252838055706997...
%C A259776 7  0.0172064353582683268003622374813...  5.5979905586951369718393573797927...
%C A259776 8  0.0094902135663231445267663712259...  6.3363450921766600853069060904417...
%C A259776 9  0.00520430877801650454166967632...    7.0741444217884608367707985...
%C A259776 10 0.0028405987031922...                 7.811548995086...
%C A259776 (End)
%H A259776 Alois P. Heinz, <a href="/A259776/b259776.txt">Antidiagonals n = 0..36, flattened</a>
%F A259776 A(n,k) = Sum_{j=0..k} A259784(n,j).
%e A259776 Square array A(n,k) begins:
%e A259776   1, 1,  1,   1,   1,    1,    1,    1, ...
%e A259776   0, 0,  0,   0,   0,    0,    0,    0, ...
%e A259776   0, 1,  1,   1,   1,    1,    1,    1, ...
%e A259776   0, 0,  2,   2,   2,    2,    2,    2, ...
%e A259776   0, 1,  4,   9,   9,    9,    9,    9, ...
%e A259776   0, 0,  6,  24,  44,   44,   44,   44, ...
%e A259776   0, 1, 13,  57, 168,  265,  265,  265, ...
%e A259776   0, 0, 24, 140, 536, 1280, 1854, 1854, ...
%p A259776 b:= proc(n, s, k) option remember; `if`(n=0, 1, `if`(n+k in s,
%p A259776       b(n-1, (s minus {n+k}) union `if`(n-k>1, {n-k-1}, {}), k),
%p A259776       add(`if`(j=n, 0, b(n-1, (s minus {j}) union
%p A259776       `if`(n-k>1, {n-k-1}, {}), k)), j=s)))
%p A259776     end:
%p A259776 A:= (n, k)-> `if`(k=0, `if`(n=0, 1, 0), b(n, {$max(1, n-k)..n}, k)):
%p A259776 seq(seq(A(n, d-n), n=0..d), d=0..12);
%t A259776 b[n_, s_, k_] := b[n, s, k] = If[n==0, 1, If[MemberQ[s, n+k], b[n-1, Join[s ~Complement~ {n+k}] ~Union~ If[n-k>1, {n-k-1}, {}], k], Sum[If[j==n, 0, b[n -1, Join[s ~Complement~ {j}] ~Union~ If[n-k>1, {n-k-1}, {}], k]], {j, s}]] ];
%t A259776 A[n_, k_] := If[k == 0, If[n == 0, 1, 0], b[n, Range[Max[1, n-k], n], k]];
%t A259776 Table[A[n, d-n], {d, 0, 12}, {n, 0, d}] // Flatten (* _Jean-Fran√ßois Alcover_, Mar 29 2017, translated from Maple *)
%Y A259776 Columns k=0-10 give: A000007, A059841, A033305, A079997, A259777, A259778, A259779, A259780, A259781, A259782, A259783.
%Y A259776 Main diagonal gives: A000166.
%Y A259776 Cf. A259784.
%K A259776 nonn,tabl
%O A259776 0,19
%A A259776 _Alois P. Heinz_, Jul 05 2015
