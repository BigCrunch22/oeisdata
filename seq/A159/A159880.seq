%I A159880 #30 Dec 28 2023 09:18:26
%S A159880 0,1,2,0,1,2,3,0,1,3,0,1,2,3,0,2,3,0,1,2,3,1,2,3,4,0,1,4,0,1,2,4,0,2,
%T A159880 4,0,1,2,4,1,2,4,0,1,2,0,1,2,3,4,0,3,4,0,1,3,4,1,3,4,0,1,3,0,1,3,4,0,
%U A159880 1,4,0,1,2,3,4,2,3,4,0,2,3,0,2,3,4,0,2,4,0,2,3,4,0,3,4,0,1,2,3,1,2,3,4,1,2,4,1,2,3,4,1,3,4,1,2,3,4,2,3,4,5
%N A159880 Infinite string related to Ehrlich's swap method for generating permutations.
%C A159880 a(n) is the position of the zero in the inverse permutation of the one generated by "Algorithm E" given in D. E. Knuth, TAOCP, Section 7.2.1.2.
%C A159880 Alternatively, the first element in the permutation (see example).
%C A159880 Starting with the identical permutation, the list of permutations in star-transposition order can be generated by swapping p(a(n)) with p(a(n+1)). - _Joerg Arndt_, Dec 25 2023
%H A159880 Joerg Arndt, <a href="/A159880/b159880.txt">Table of n, a(n) for n = 0..5039</a>
%H A159880 Joerg Arndt, <a href="http://www.jjj.de/fxt/#fxtbook">Matters Computational (The Fxtbook)</a>, section 10.8 "Star-transposition order", pp.257-258
%H A159880 D. E. Knuth, TAOCP, Section 7.2.1.2.
%F A159880 a(k!) = k (for k>=1) and a(j) < k for j<k!. [_Joerg Arndt_, Mar 20 2014]
%e A159880           permutation     swap    inverse permutation
%e A159880    0:    [ 0 1 2 3 ]                [ 0 1 2 3 ]
%e A159880    1:    [ 1 0 2 3 ]     (0, 1)     [ 1 0 2 3 ]
%e A159880    2:    [ 2 0 1 3 ]     (0, 2)     [ 1 2 0 3 ]
%e A159880    3:    [ 0 2 1 3 ]     (0, 1)     [ 0 2 1 3 ]
%e A159880    4:    [ 1 2 0 3 ]     (0, 2)     [ 2 0 1 3 ]
%e A159880    5:    [ 2 1 0 3 ]     (0, 1)     [ 2 1 0 3 ]
%e A159880    6:    [ 3 1 0 2 ]     (0, 3)     [ 2 1 3 0 ]
%e A159880    7:    [ 0 1 3 2 ]     (0, 2)     [ 0 1 3 2 ]
%e A159880    8:    [ 1 0 3 2 ]     (0, 1)     [ 1 0 3 2 ]
%e A159880    9:    [ 3 0 1 2 ]     (0, 2)     [ 1 2 3 0 ]
%e A159880   10:    [ 0 3 1 2 ]     (0, 1)     [ 0 2 3 1 ]
%e A159880   11:    [ 1 3 0 2 ]     (0, 2)     [ 2 0 3 1 ]
%e A159880   12:    [ 2 3 0 1 ]     (0, 3)     [ 2 3 0 1 ]
%e A159880   13:    [ 3 2 0 1 ]     (0, 1)     [ 2 3 1 0 ]
%e A159880   14:    [ 0 2 3 1 ]     (0, 2)     [ 0 3 1 2 ]
%e A159880   15:    [ 2 0 3 1 ]     (0, 1)     [ 1 3 0 2 ]
%e A159880   16:    [ 3 0 2 1 ]     (0, 2)     [ 1 3 2 0 ]
%e A159880   17:    [ 0 3 2 1 ]     (0, 1)     [ 0 3 2 1 ]
%e A159880   18:    [ 1 3 2 0 ]     (0, 3)     [ 3 0 2 1 ]
%e A159880   19:    [ 2 3 1 0 ]     (0, 2)     [ 3 2 0 1 ]
%e A159880   20:    [ 3 2 1 0 ]     (0, 1)     [ 3 2 1 0 ]
%e A159880   21:    [ 1 2 3 0 ]     (0, 2)     [ 3 0 1 2 ]
%e A159880   22:    [ 2 1 3 0 ]     (0, 1)     [ 3 1 0 2 ]
%e A159880   23:    [ 3 1 2 0 ]     (0, 2)     [ 3 1 2 0 ]
%o A159880 (PARI)
%o A159880 ss( n ) =
%o A159880 {
%o A159880   my(k, f, nf, v);
%o A159880   f = 1; k = 2; /* f==(k-1)! */
%o A159880   nf = f * k; /* nf==k! */
%o A159880   v = vector(n);
%o A159880   for ( p=1, #v-1,
%o A159880     if ( p>=nf, f=nf; k+=1; nf*=k );
%o A159880     v[p+1] = (v[p-f+1]-1) % k;
%o A159880   );
%o A159880   return(v);
%o A159880 }
%o A159880 ss( 5! )
%o A159880 (PARI)  \\ individual terms:
%o A159880 a( n ) =
%o A159880 {
%o A159880     my( ret = 0, k = 0 );
%o A159880     while ( n != 0 ,
%o A159880         k += 1;
%o A159880         my( d = n % (k+1) );
%o A159880         n \= (k+1);
%o A159880         ret = (ret - d) % (k+1);
%o A159880     );
%o A159880     return( ret );
%o A159880 }
%o A159880 vector(5!, n, a(n-1) )  \\ _Joerg Arndt_, Dec 28 2023
%Y A159880 Cf. A123400 (giving the nonzero position in "swap" in example).
%K A159880 nonn
%O A159880 0,3
%A A159880 _Joerg Arndt_, Apr 25 2009
