%I A373390 #37 Jun 18 2024 19:53:53
%S A373390 1,2,3,4,9,8,15,14,5,6,7,10,21,16,25,12,35,18,49,20,27,22,39,11,13,24,
%T A373390 55,26,33,28,45,32,51,38,17,19,30,77,34,57,40,63,44,65,36,85,42,95,46,
%U A373390 75,23,48,91,50,69,52,81,56,87,62,29,31,54,115,58,93,64,99,68,105,74,117,37,60,119,66
%N A373390 a(n) = n for n <= 3; for n > 3, a(n) is the smallest unused positive number that is coprime to a(n-1) but has a common factor with at least one of a(1)...a(n-2).
%C A373390 The sequence uses a criterion for selecting the next term similar to those that define A098550 and A247942, but here all terms prior to a(n-1) can be checked for a common factor with a(n).
%C A373390  The terms appear to follow a pattern similar to the EKG sequence A064413, i.e., the terms are concentrated along just three lines of different gradient, and the lower line consists only of primes. Prime powers appear in the upper two lines, with the powers of 2 greater than 32 falling on the middle line while all others fall on the top line. See the attached image for the first 1000 terms. For the first 100000 terms the primes appear in their natural order, implying that is likely true for all n.
%C A373390 The fixed points are 1, 2, 3, 4, 18, 20, 22, 32, 98, and it is likely that no more exist. Given that A098550 and A247942 are permutations of the positive integers, it is almost certainly true that this sequence is also.
%C A373390 From _Michael De Vlieger_, Jun 07 2024: (Start)
%C A373390 Scatterplot shows 3 trajectories as follows:
%C A373390 "Alpha" is a trajectory of odd composite numbers (highest "slope").
%C A373390 "Gamma" is a trajectory of even composite numbers.
%C A373390 "Beta" is the trajectory of primes and the number 1 (lowest "slope"). (End)
%H A373390 Scott R. Shannon, <a href="/A373390/b373390.txt">Table of n, a(n) for n = 1..10000</a>
%H A373390 Scott R. Shannon, <a href="/A373390/a373390.png">Image of the first 1000 terms</a>. Numbers with one, two, three, or four and more distinct prime factors are show as red, yellow, green and violet respectively. The white line is a(n) = n.
%H A373390 Michael De Vlieger, <a href="/A373390/a373390_1.png">Log log scatterplot of a(n)</a>, n = 1..2^16, showing primes in red, odd nonprimes in green, and composite even numbers in blue.
%H A373390 Michael De Vlieger, <a href="/A373390/a373390_2.png">Log log scatterplot of a(n)</a>, n = 1..2^14, showing primes in red, perfect prime powers in gold, squarefree composites in green, and numbers neither squarefree nor prime powers in blue and purple, with purple additionally indicating powerful numbers that are not prime powers.
%H A373390 Michael De Vlieger, <a href="/A373390/a373390.txt">Table of n, a(n) for n = 1..131072</a>
%e A373390 a(11) = 7 as 7 is coprime to a(10) = 6 while sharing a factor with a(8) = 14. This is the first term to differ from A098550.
%e A373390 a(38) = 77 as 77 is coprime to a(37) = 30 while sharing a factor with a(30) = 28. This is the first term to differ from A247942.
%t A373390 c[_] := False; p[_] := False; nn = 120;
%t A373390 Array[Set[{a[#], c[#], p[#]}, {#, True, True}] &, 3];
%t A373390 i = a[2]; j = a[3]; u = 4;
%t A373390 Do[k = u;
%t A373390  While[Or[c[k], ! CoprimeQ[j, k],
%t A373390    NoneTrue[Set[s, #], p] &@FactorInteger[k][[All, 1]]], k++];
%t A373390  Map[Set[p[#], True] &, s];
%t A373390  Set[{a[n], c[k], i, j}, {k, True, j, k}];
%t A373390  If[k == u, While[c[u], u++]], {n, 4, nn}];
%t A373390 Array[a, nn] (* _Michael De Vlieger_, Jun 06 2024 *)
%o A373390 (Python)
%o A373390 from math import gcd, lcm
%o A373390 from itertools import count, islice
%o A373390 def agen(): # generator of terms
%o A373390     yield from [1, 2, 3]
%o A373390     aset, an, LCM, mink = {1, 2, 3}, 3, 6, 4
%o A373390     while True:
%o A373390         an = next(k for k in count(mink) if k not in aset and gcd(k, an) == 1 and gcd(k, LCM) > 1)
%o A373390         LCM = lcm(LCM, an)
%o A373390         aset.add(an)
%o A373390         while mink in aset: mink += 1
%o A373390         yield an
%o A373390 print(list(islice(agen(), 76))) # _Michael S. Branicky_, Jun 18 2024
%Y A373390 Cf. A098550, A247942, A064413, A336957.
%K A373390 nonn,new
%O A373390 1,2
%A A373390 _Scott R. Shannon_, Jun 03 2024
