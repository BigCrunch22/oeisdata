%I A302055 #16 Apr 15 2018 15:06:01
%S A302055 0,0,1,1,4,1,5,1,12,6,7,1,16,1,9,8,32,1,21,1,24,27,13,1,44,10,15,10,
%T A302055 32,1,31,1,80,39,19,12,60,1,21,14,68,1,75,1,48,102,25,1,112,14,45,55,
%U A302055 56,1,47,75,92,57,31,1,92,1,33,16,192,16,111,1,72,150,59,1,156,1,39,20,80,18,67,1,176,81,43,1,192,95,45,71,140,1,249,147,96
%N A302055 An arithmetic derivative analog for nonstandard factorization process based on the sieve of Eratosthenes (A083221).
%C A302055 The formula is analogous to _Reinhard Zumkeller_'s May 09 2011 formula in A003415, with A032742 replaced by A302042. See the comments in the latter sequence.
%C A302055 Note that this cannot be computed just as f(n) = A003415(A250246(n)), in contrast to many other such analogs, like A253557, A302039, A302041, A302050, A302051 and A302052.
%H A302055 Antti Karttunen, <a href="/A302055/b302055.txt">Table of n, a(n) for n = 0..65537</a>
%H A302055 <a href="/index/Si#sieve">Index entries for sequences generated by sieves</a>
%F A302055 a(0) = a(1) = 0; for n > 1, a(n) = (A020639(n)*a(A302042(n))) + A302042(n).
%o A302055 (PARI)
%o A302055 up_to = 65537;
%o A302055 ordinal_transform(invec) = { my(om = Map(), outvec = vector(length(invec)), pt); for(i=1, length(invec), if(mapisdefined(om,invec[i]), pt = mapget(om, invec[i]), pt = 0); outvec[i] = (1+pt); mapput(om,invec[i],(1+pt))); outvec; };
%o A302055 A020639(n) = if(n>1, if(n>n=factor(n, 0)[1, 1], n, factor(n)[1, 1]), 1); \\ From A020639.
%o A302055 v078898 = ordinal_transform(vector(up_to,n,A020639(n)));
%o A302055 A078898(n) = v078898[n];
%o A302055 A302042(n) = if((1==n)||isprime(n),1,my(c = A078898(n), p = prime(-1+primepi(A020639(n))+primepi(A020639(c))), d = A078898(c), k=0); while(d, k++; if((1==k)||(A020639(k)>=p),d -= 1)); (k*p));
%o A302055 A302055(n) = if(n<2,0,my(k=A302042(n)); (A020639(n)*A302055(k))+k);
%Y A302055 Cf. A003415, A020639, A078898, A083221, A302042.
%K A302055 nonn
%O A302055 0,5
%A A302055 _Antti Karttunen_, Mar 31 2018
