%I A248120 #82 Feb 22 2023 23:13:51
%S A248120 1,2,6,3,24,36,4,120,360,60,80,5,720,3600,1800,1200,300,150,6,5040,
%T A248120 37800,37800,16800,3150,12600,3150,420,630,252,7,40320,423360,705600,
%U A248120 235200,176400,352800,58800,35280,23520,35280,7056,1960,1176,392,8
%N A248120 Triangle read by rows: Lagrange (compositional) inversion of a function in terms of the coefficients of the Taylor series expansion of its reciprocal, scaled version of A248927, n >= 1, k = 1..A000041(n-1).
%C A248120 Coefficients are listed in reverse graded colexicographic order (A228100). This is the reverse of Abramowitz and Stegun order (A036036).
%C A248120 Coefficients for Lagrange (compositional) inversion of a function in terms of the Taylor series expansion of its shifted reciprocal. Complementary to A134264 for formal power series and a scaled version of A248927. A refinement of A055302, which enumerates the number of labeled rooted trees with n nodes and k leaves, with row sums A000169.
%C A248120 Given an invertible function f(t) analytic about t=0 with f(0)=0 and df(0)/dt not 0, form h(t) = t / f(t) and denote h_n = (n') as the coefficient of t^n/n! in h(t). Then the compositional inverse of f(t), g(t), as a formal Taylor series, or e.g.f., is given up to the first few orders by
%C A248120 g(t) =   [ 1 (0') ] * t
%C A248120        + [ 2 (0') (1') ] * t^2/2!
%C A248120        + [ 6 (0') (1')^2 + 3 (0')^2 (2') ] * t^3/3!
%C A248120        + [24 (0') (1')^3 + 36 (0')^2 (1') (2') + 4 (0')^3 (3')] * t^4/4!
%C A248120        + [120 (0') (1')^4 + 360 (0')^2 (1')^2 (2') + (0')^3 [60 (2')^2
%C A248120            + 80 (1') (3')] + 5 (0')^4 (4')] * t^5/5!
%C A248120        + [720 (0')(1')^5 + 3600 (0')^2 (1')^3(2') + (0')^3 [1800 (1')(2')^2 + 1200 ( 1')^2(3')] + (0')^4 [300 (2')(3') + 150 (1')(4')] + 6 (0')^5 (5')] * t^6/6! + ... .
%C A248120 Operating with [1/(n*(n-1))] d/d(1') = [1/(n*(n-1))] d/d(h_1) on the n-th partition polynomial in square brackets above associated with t^n/n! generates the (n-1)-th partition polynomial.
%C A248120 Each n-th partition polynomial here is n times the (n-1)-th partition polynomial of A248927.
%C A248120 From _Tom Copeland_, Nov 24 2014: (Start)
%C A248120 The n-th row is a mapping of the homogeneous symmetric monomials generated by [x(1) + x(2) + ... + x(n)]^(n-1) under the umbral mapping x(m)^j = h_j, for any m. E.g., [a + b + c]^2 = [a^2 + b^2 + c^2] + 2 * [a*b + a*c + b*c] is mapped to [3 * h_2] + 2 * [3 * h_1 * h_1] = 3 * h_2 + 6 *  h_1^2 = A248120(3) with h_0 = 1. (Example corrected Jul 14 2015.)
%C A248120 For another example and relations to A134264 and A036038, see A134264. The general relation is n * A134264(n) = A248120(n) / A036038(n-1) where the arithmetic is performed on the coefficients of matching partitions in each row n.
%C A248120 The Abramowitz and Stegun reference in A036038 gives combinatorial interpretations of A036038 and relations to other number arrays.
%C A248120 This can also be related to repeated umbral composition of Appell sequences and topology with the Bernoulli numbers playing a special role. See the Todd class link. (End)
%C A248120 As presented above and in the Copeland link, this entry is related to exponentiation of e.g.f.s and, therefore, to discussions in the Scott and Sokal preprint (see eqn. 3.1 on p. 10 and eqn. 3.62 p. 24). - _Tom Copeland_, Jan 17 2017
%H A248120 Andrew Howroyd, <a href="/A248120/b248120.txt">Table of n, a(n) for n = 1..2087</a> (rows 1..20)
%H A248120 M. Abramowitz and I. A. Stegun, eds., <a href="http://www.convertit.com/Go/ConvertIt/Reference/AMS55.ASP">Handbook of Mathematical Functions</a>, National Bureau of Standards, Applied Math. Series 55, Tenth Printing, 1972 [alternative scanned copy].
%H A248120 Tom Copeland, <a href="http://tcjpn.wordpress.com/2014/12/14/the-hirzebruch-criterion-fo-the-todd-class/">The Hirzebruch criterion for the Todd class</a>, Dec 14 2014.
%H A248120 A. Scott and A. Sokal, <a href="http://arxiv.org/abs/0803.1477">Some variants of the exponential formula, with application to the multivariate Tutte polynomial (alias Potts model)</a>, arXiv:0803.1477 [math.CO], 2009.
%F A248120 For j>1, there are P(j,m;a...) = j! / [ (j-m)! (a_1)! (a_2)! ... (a_(j-1))! ] permutations of h_0 through h_(j-1) in which h_0 is repeated (j-m) times; h_1, repeated a_1 times; and so on with a_1 + a_2 + ... + a_(j-1) = m.
%F A248120 If, in addition, a_1 + 2 * a_2 + ... + (j-1) * a_(j-1) = j-1, then each distinct combination of these arrangements is correlated with a partition of j-1.
%F A248120 T(j,k) is (j-1)! P(j,m;a...) / [(2!)^a_2 (3!)^a_3 ... ((j-1)!)^a_(j-1) ] for the k-th partition of j-1. The partitions are in reverse order--from bottom to top--from the order in Abramowitz and Stegun (page 831).
%F A248120 For example, from g(t) above, T(6,3) = 5! * [6!/(3!*2!)]/(2!)^2 = 1800 for the 3rd partition from the bottom under n=6-1=5 with m=3 parts, and T(6,5) = 5! * [6!/4!]/(2!*3!) = 300.
%F A248120 If the initial factorial and final denominator of T(n,k) are removed and the expression divided by j and the partitions reversed in order, then A134264 is obtained, a refinement of the Narayana numbers.
%F A248120 For f(t) = t*e^(-t), g(t) = T(t), the Tree function, which is the e.g.f. of A000169, and h(t) = t/f(t) = e^t, so h_n = 1 for all n in this case; therefore, the row sums are A000169(n) = n^(n-1) = n* A000272(n).
%F A248120 Let W(x) = 1/(df(x)/dx)= 1/{d[x/h(x)]/dx}=1/[d{x/[h_0+h_1*x+ ...]/dx]. Then the partition polynomials above are given by (W(x)*d/dx)^n x, evaluated at x=0, and the compositional inverse of f(t) is g(t)=exp(t*W(x)*d/dx) x, evaluated at x=0. Also, dg(t)/dt = W(g(t)). See A145271.
%F A248120 With exp[x* PS(.,t)] = exp[t*g(x)]=exp[x*W(y)d/dy] exp(t*y) eval. at y=0, the raising (creation) and lowering (annihilation) operators defined by R PS(n,t) = PS(n+1,t) and L PS(n,t)= n * PS(n-1,t) are R = t * W(d/dt) and L =(d/dt)/h(d/dt)=(d/dt) 1/[(h_0)+(h_1)*d/dt+(h_2)*(d/dt)^2/2!+...], which will give a lowering operator associated to the refined f-vectors of permutohedra (cf. A133314 and A049019).
%F A248120 Then [dPS(n,z)/dz]/n eval. at z=0 are the row partition polynomials of this entry. (Cf. A139605, A145271, and link therein to Mathemagical Forests for relation to planted trees on p. 13.)
%F A248120 Following the notes connected to the Lagrange reversion theorem in A248927, a generator for the n-th partition polynomial P_n of this entry is (d/dx)^(n-1) (h (x))^n, and -log(1-t*P.) = (t*Q.) / (1 - t*Q.), umbrally, where (Q.)^n = Q_n is the n-th partition polynomial of A248927. - _Tom Copeland_, Nov 25 2016
%F A248120 With h_0 = 1, the n-th partition polynomial is obtained as the n-th element (with initial index 0) of the first column of M^{n+1}, where M is the matrix with M_{i,j}= binomial(i,j) h_{i-j}, i.e., the lower triangular Pascal matrix with its n-th diagonal multiplied by h_n. This follows from the Lagrange inversion theorem and the relation between powers of matrices such as M and powers of formal Taylor series discussed in A133314. This is equivalent to repeated binomial convolution of the coefficients of the Taylor series with itself. - _Tom Copeland_, Nov 13 2019
%F A248120 T(n,k) = n*A248927(n,k). - _Andrew Howroyd_, Feb 02 2022
%e A248120 Triangle begins
%e A248120      1;
%e A248120      2;
%e A248120      6,     3;
%e A248120     24,    36,     4;
%e A248120    120,   360,    60,    80,    5;
%e A248120    720,  3600,  1800,  1200,  300,   150,    6;
%e A248120   5040, 37800, 37800, 16800, 3150, 12600, 3150, 420, 630, 252, 7;
%e A248120   ...
%e A248120 For f(t)= e^t-1, h(t)= t/f(t)= t/(e^t-1), the e.g.f. for the Bernoulli numbers, and plugging the Bernoulli numbers into the Lagrange inversion formula gives g(t)= t - t^2/2 + t^3/3 + ... = log(1+t).
%o A248120 (PARI)
%o A248120 C(v)={my(n=vecsum(v), S=Set(v)); (n+1)*n!^2/((n-#v+1)!*prod(i=1, #S, my(x=S[i], c=#select(y->y==x, v)); x!^c*c!))}
%o A248120 row(n)=[C(Vec(p)) | p<-Vecrev(partitions(n-1))]
%o A248120 { for(n=1, 7, print(row(n))) } \\ _Andrew Howroyd_, Feb 02 2022
%Y A248120 Cf. A145271, A000169, A000272, A139605, A055302, A133314, A049019.
%Y A248120 Cf. A134264 and A248927, "scaled" versions of this Lagrange inversion.
%Y A248120 Cf. A036038.
%K A248120 nonn,tabf
%O A248120 1,2
%A A248120 _Tom Copeland_, Oct 28 2014
%E A248120 Terms a(31) and beyond from _Andrew Howroyd_, Feb 02 2022
